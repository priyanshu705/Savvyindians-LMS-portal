{% load i18n%}
{% load static %}

<!-- Modern CSS Link -->
<link rel="stylesheet" href="{% static 'css/modern-theme.css' %}">

<script>
// Modern Sticky Navbar with Scroll Effect
document.addEventListener('DOMContentLoaded', function() {
    const navbar = document.getElementById('top-navbar');
    let lastScroll = 0;
    
    window.addEventListener('scroll', function() {
        const currentScroll = window.pageYOffset;
        
        // Add/remove scrolled class
        if (currentScroll > 50) {
            navbar.classList.add('scrolled');
        } else {
            navbar.classList.remove('scrolled');
        }
        
        lastScroll = currentScroll;
    });
});
</script>

<style>
/* Ultra Modern Navbar - Sticky & Transparent */
#top-navbar {
	background: rgba(0, 0, 0, 0.7) !important;
	backdrop-filter: blur(20px) !important;
	-webkit-backdrop-filter: blur(20px) !important;
	border-bottom: 1px solid rgba(255, 215, 0, 0.15) !important;
	box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3) !important;
	position: fixed !important;
	top: 0 !important;
	left: 0 !important;
	right: 0 !important;
	width: 100% !important;
	z-index: 9999 !important;
	transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
	padding: 0.75rem 0 !important;
}

/* Scrolled State - More Opaque */
#top-navbar.scrolled {
	background: rgba(0, 0, 0, 0.95) !important;
	backdrop-filter: blur(30px) !important;
	box-shadow: 0 8px 32px rgba(255, 215, 0, 0.2) !important;
	border-bottom: 1px solid rgba(255, 215, 0, 0.3) !important;
	padding: 0.5rem 0 !important;
}

/* Main Navigation Menu Styles */
.main-nav-menu {
	display: flex;
	align-items: center;
	gap: 1.5rem;
	margin-left: 2rem;
}

.nav-link-modern {
	color: #ffffff;
	text-decoration: none;
	font-weight: 500;
	font-size: 0.95rem;
	padding: 0.5rem 1rem;
	border-radius: 8px;
	transition: all 0.3s ease;
	display: flex;
	align-items: center;
	gap: 0.5rem;
}

.nav-link-modern i {
	font-size: 1rem;
}

.nav-link-modern:hover {
	background: rgba(255, 215, 0, 0.1);
	color: #ffd700;
	transform: translateY(-2px);
}

.nav-link-modern.active {
	background: rgba(255, 215, 0, 0.15);
	color: #ffd700;
}

@media (max-width: 992px) {
	.main-nav-menu {
		display: none;
	}
}

.nav-wrapper .toggle-btn {
	background: #ffd700;
	color: #000000;
	border: none;
	border-radius: 10px;
	padding: 0.75rem;
	transition: all 0.3s ease;
	cursor: pointer;
	flex-shrink: 0;
}

.nav-wrapper .toggle-btn:hover {
	transform: scale(1.05);
	box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
	background: #ffed4e;
}

/* Nav Wrapper Layout Fix */
.nav-wrapper {
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: 1rem;
	width: 100%;
}

/* Enhanced Search Bar */
.form-header {
	position: relative;
	flex: 1;
	max-width: 600px;
	display: flex;
	margin: 0 1rem;
}

.form-header input {
	border: 2px solid rgba(255, 215, 0, 0.3);
	border-radius: 25px 0 0 25px;
	padding: 0.75rem 1.25rem;
	font-size: 0.9rem;
	transition: all 0.3s ease;
	background: rgba(17, 17, 17, 0.9);
	color: #ffffff;
	flex: 1;
	min-width: 0;
}

.form-header input::placeholder {
	color: #888888;
}

.form-header input:focus {
	border-color: #ffd700;
	box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.1);
	background: #1a1a1a;
	outline: none;
}

.form-header button {
	background: #ffd700;
	border: 2px solid #ffd700;
	border-radius: 0 25px 25px 0;
	padding: 0.75rem 1.5rem;
	color: #000000;
	transition: all 0.3s ease;
	font-weight: 600;
	border-left: none;
	flex-shrink: 0;
}

.form-header button:hover {
	background: #ffed4e;
	border-color: #ffed4e;
	transform: scale(1.02);
	box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
}

/* Enhanced User Dropdown */
.user-dropdown .avatar {
	border: 3px solid #ffd700;
	background: #ffd700;
	padding: 3px;
	transition: all 0.3s ease;
	cursor: pointer;
	border-radius: 50%;
}

.user-dropdown .avatar:hover {
	transform: scale(1.05);
	box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
	border-color: #ffed4e;
}

.user-dropdown .avatar img {
	border-radius: 50%;
}

/* Enhanced Dropdown Menu */
.modern-dropdown {
	border: none;
	border-radius: 15px;
	box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
	backdrop-filter: blur(10px);
	background: rgba(255, 255, 255, 0.95);
	padding: 1rem 0;
	margin-top: 0.5rem;
}

.dropdown-header-modern {
	padding: 1rem;
	text-align: center;
	border-bottom: 1px solid rgba(0, 0, 0, 0.05);
	margin-bottom: 0.5rem;
}

.dropdown-header-modern .avatar-md {
	border: 3px solid #ffd700;
	margin-bottom: 0.5rem;
}

.dropdown-header-modern .user-name {
	font-weight: 600;
	color: #2d3748;
	margin: 0;
}

.dropdown-header-modern .last-login {
	font-size: 0.8rem;
	color: #718096;
	margin: 0;
}

.modern-dropdown .dropdown-item {
	padding: 0.75rem 1.5rem;
	color: #4a5568;
	transition: all 0.3s ease;
	border-radius: 0;
}

.modern-dropdown .dropdown-item:hover {
	background: linear-gradient(90deg, rgba(255, 215, 0, 0.1) 0%, transparent 100%);
	color: #ffd700;
	transform: translateX(5px);
}

.modern-dropdown .dropdown-item i {
	width: 20px;
	text-align: center;
	margin-right: 0.75rem;
	background: none;
	font-size: 1rem;
}

.logout-btn {
	background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
	border: none;
	color: white;
	padding: 0.5rem 1.5rem;
	border-radius: 20px;
	font-size: 0.9rem;
	font-weight: 500;
	transition: all 0.3s ease;
}

.logout-btn:hover {
	background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
	transform: scale(1.02);
	color: white;
}

/* Authentication Buttons */
.auth-buttons {
	display: flex;
	align-items: center;
	gap: 0.75rem;
	flex-shrink: 0;
	margin-left: auto;
}

.login-nav-btn {
	border: 2px solid #ffd700;
	color: #ffd700 !important;
	background: transparent;
	border-radius: 20px;
	padding: 0.5rem 1.25rem;
	font-weight: 600;
	font-size: 0.9rem;
	transition: all 0.3s ease;
	text-decoration: none;
	white-space: nowrap;
	display: inline-flex;
	align-items: center;
	gap: 0.5rem;
}

.login-nav-btn:hover {
	background: #ffd700;
	color: #000000 !important;
	border-color: #ffd700;
	transform: translateY(-1px);
	box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
}

.register-nav-btn {
	background: #ffd700;
	border: 2px solid #ffd700;
	color: #000000 !important;
	border-radius: 20px;
	padding: 0.5rem 1.25rem;
	font-weight: 700;
	font-size: 0.9rem;
	transition: all 0.3s ease;
	text-decoration: none;
	white-space: nowrap;
	display: inline-flex;
	align-items: center;
	gap: 0.5rem;
}

.register-nav-btn:hover {
	background: #ffed4e;
	border-color: #ffed4e;
	color: #000000 !important;
	transform: translateY(-1px);
	box-shadow: 0 4px 15px rgba(255, 215, 0, 0.5);
}

/* Responsive Design */
@media (max-width: 1200px) {
	.form-header {
		max-width: 400px;
	}
	
	.login-nav-btn,
	.register-nav-btn {
		padding: 0.45rem 1rem;
		font-size: 0.85rem;
	}
}

@media (max-width: 992px) {
	.main-nav-menu {
		display: none;
	}
	
	.form-header {
		max-width: 350px;
		flex: 1;
		margin: 0 0.75rem;
	}
	
	.auth-buttons {
		gap: 0.5rem;
	}
	
	.login-nav-btn,
	.register-nav-btn {
		padding: 0.4rem 0.9rem;
		font-size: 0.8rem;
	}
}

@media (max-width: 768px) {
	.form-header {
		flex: 1;
		margin: 0 0.5rem;
		max-width: 250px;
	}
	
	.form-header input {
		font-size: 0.85rem;
		padding: 0.6rem 1rem;
	}
	
	.form-header button {
		padding: 0.6rem 1rem;
	}
	
	.form-header button i {
		font-size: 0.9rem;
	}
	
	.auth-buttons {
		gap: 0.4rem;
	}
	
	.login-nav-btn,
	.register-nav-btn {
		font-size: 0.75rem;
		padding: 0.4rem 0.8rem;
	}
	
	.login-nav-btn i,
	.register-nav-btn i {
		display: none;
	}
	
	.navbar-brand-logo img {
		height: 30px;
	}
}

@media (max-width: 576px) {
	.form-header {
		max-width: 180px;
	}
	
	.form-header input {
		font-size: 0.75rem;
		padding: 0.5rem 0.75rem;
	}
	
	.form-header button {
		padding: 0.5rem 0.75rem;
	}
	
	.form-header button span {
		display: none;
	}
	
	#top-navbar .nav-wrapper {
		gap: 0.4rem;
	}
	
	.login-nav-btn,
	.register-nav-btn {
		font-size: 0.7rem;
		padding: 0.35rem 0.7rem;
	}
	
	.navbar-brand-logo img {
		height: 28px;
	}
}
</style>

<div id="top-navbar" class="py-2">
	<div class="container">
		<div class="nav-wrapper">
			
			<!-- SavvyIndians Logo -->
			<a href="{% url 'home' %}" class="navbar-brand-logo" title="SavvyIndians - Create Smarter with AI">
				<img src="{% static 'img/savvyindians-logo.png' %}" 
					 alt="SavvyIndians" 
					 loading="lazy">
			</a>

			<!-- Main Navigation Menu -->
			<nav class="main-nav-menu">
				<a href="{% url 'home' %}" class="nav-link-modern">
					<i class="fas fa-home"></i> Home
				</a>
				<!-- Use the existing 'programs' URL and add a query param to filter by type -->
				<a href="{% url 'programs' %}?type=bootcamp" class="nav-link-modern">
					<i class="fas fa-laptop-code"></i> Bootcamps
				</a>
				<a href="{% url 'programs' %}?type=masterclass" class="nav-link-modern">
					<i class="fas fa-chalkboard-teacher"></i> Masterclasses
				</a>
			</nav>

			<form class="form-header" action="/search/" method="GET">
				<input id="primary-search" 
					   class="form-control" 
					   type="text" 
					   name="q" 
					   value="{{ request.GET.q }}"
					   placeholder="{% trans 'Search courses, programs, quizzes, news...' %}" 
					   required />
				<button class="btn" type="submit">
					<i class="fas fa-search"></i>
				</button>
			</form>

			{% if request.user.is_authenticated %}
			<!-- Notification Dropdown -->
			{% include 'notifications/notification_dropdown.html' %}
			<div class="dropdown user-dropdown">
				<div class="avatar" data-bs-toggle="dropdown" aria-expanded="false">
					<img src="{{ request.user.get_picture }}" alt="User Avatar">
				</div>
				<div class="dropdown-menu modern-dropdown" style="min-width: 16rem !important;">
					<div class="dropdown-header-modern">
						<div class="avatar avatar-md">
							<img src="{{ request.user.get_picture }}" alt="User Avatar">
						</div>
						<p class="user-name">{{ request.user.get_full_name|default:request.user.username }}</p>
						<p class="last-login">
							{% trans 'Last login:' %} {{ request.user.last_login|date:"M d, Y" }}
						</p>
					</div>

					{% if request.user.is_student %}
					<a class="dropdown-item" href="{% url 'user_course_list' %}">
						<i class="fas fa-book"></i>{% trans 'My Courses' %}
					</a>
					<a class="dropdown-item" href="{% url 'student_progress_dashboard' %}">
						<i class="fas fa-chart-line"></i>{% trans 'My Progress' %}
					</a>
					{% else %}
					<a class="dropdown-item" href="{% url 'user_course_list' %}">
						<i class="fas fa-book"></i>{% trans 'My Courses' %}
					</a>
					{% endif %}

					<a class="dropdown-item" href="{% url 'profile' %}">
						<i class="fas fa-user"></i>{% trans 'Profile' %}
					</a>
					<a class="dropdown-item" href="{% url 'edit_profile' %}">
						<i class="fas fa-cog"></i>{% trans 'Settings' %}
					</a>
					
					<div class="dropdown-divider"></div>
					
					<div class="text-center px-3">
						{% if request.user.is_student %}
						<a class="btn logout-btn" href="{% url 'student_logout' %}">
							<i class="fas fa-sign-out-alt me-2"></i>{% trans 'Sign Out' %}
						</a>
						{% else %}
						<a class="btn logout-btn" href="{% url 'logout' %}">
							<i class="fas fa-sign-out-alt me-2"></i>{% trans 'Sign Out' %}
						</a>
						{% endif %}
					</div>
				</div>
			</div>
			{% else %}
			<!-- Login/Register Buttons for Non-Authenticated Users -->
			<div class="auth-buttons d-flex gap-2">
				<a href="{% url 'student_login' %}" class="btn btn-outline-primary login-nav-btn">
					<i class="fas fa-sign-in-alt me-2"></i>{% trans 'Student Login' %}
				</a>
				<a href="{% url 'student_register' %}" class="btn btn-primary register-nav-btn">
					<i class="fas fa-user-plus me-2"></i>{% trans 'Register' %}
				</a>
			</div>
			{% endif %}
		</div>
	</div>
</div>